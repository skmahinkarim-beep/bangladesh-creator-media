<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BCM Admin Panel</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f2f5; margin: 0; }
        .container { max-width: 800px; margin: 20px auto; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        h3 { color: #0056b3; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 30px; margin-bottom: 10px; }
        
        /* Size Guide Style - RED COLOR */
        .size-guide { 
            color: #d9534f; 
            font-size: 0.85rem; 
            font-weight: bold; 
            margin-top: -5px; 
            margin-bottom: 10px; 
            display: block; 
        }
        
        input, textarea, button, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        label { font-weight: bold; margin-top: 15px; display: block; color: #555; }
        .section { background: #f9f9f9; padding: 20px; margin-bottom: 25px; border-radius: 5px; border: 1px solid #e0e0e0; }
        .admin-stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        button { background: #0056b3; color: white; cursor: pointer; font-weight: bold; font-size: 1rem; border: none; }
        button:hover { background: #004494; }
        .logout-btn { background: #d9534f; margin-top: 20px; }
        .logout-btn:hover { background: #c9302c; }

        /* News Select Style */
        #news-select {
            background: #fff;
            font-size: 1.1rem;
            color: #0056b3;
            border: 2px solid #0056b3;
            font-weight: bold;
        }

        #admin-panel { display: none; }
        #login-section { max-width: 400px; margin: 50px auto; text-align: center; }

        /* AD CONTAINER STYLE */
        .ad-banner-container { text-align: center; margin: 20px auto; padding: 10px; max-width: 100%; overflow: hidden; }

        /* POPUP AD STYLES */
        .popup-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7); z-index: 9999;
            display: none; justify-content: center; align-items: center;
            backdrop-filter: blur(4px);
        }
        .popup-content {
            background: white; padding: 20px; border-radius: 12px;
            width: 350px; text-align: center; position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            animation: popIn 0.4s ease;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border: 4px solid #f0f2f5; 
        }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .popup-close {
            position: absolute; top: -15px; right: -15px;
            background: red; color: white; border: 2px solid white;
            width: 35px; height: 35px; border-radius: 50%;
            font-size: 20px; line-height: 32px; cursor: pointer;
            font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

    <!-- Login Section -->
    <div id="login-section" class="container">
        <h3>Admin Login</h3>
        <input type="email" id="email" placeholder="Admin Email">
        <input type="password" id="password" placeholder="Password">
        <button onclick="login()">Login</button>
    </div>

    <!-- Main Admin Panel -->
    <div id="admin-panel" class="container">
        <h1>Website Control Panel</h1>

        <!-- ADSTERRA BANNER 728x90 -->
        <div class="ad-banner-container">
            <script>
                atOptions = {
                    'key' : '913c56baf27591442617260739df7bf0',
                    'format' : 'iframe',
                    'height' : 90,
                    'width' : 728,
                    'params' : {}
                };
            </script>
            <script src="https://www.highperformanceformat.com/913c56baf27591442617260739df7bf0/invoke.js"></script>
        </div>
        
        <!-- 1. BREAKING NEWS -->
        <div class="section" style="border-left: 5px solid #ff0000; background: #fff5f5;">
            <h3 style="margin-top: 0; color: #d32f2f;">üì¢ Breaking News Ticker</h3>
            <label>Scrolling Text:</label>
            <input type="text" id="breaking-news" placeholder="Write breaking news here... (Leave empty to hide ticker)">
        </div>

        <!-- 2. Top Banners -->
        <div class="section">
            <h3>2. Top Full-Screen Banners</h3>
            
            <label>Banner 1:</label>
            <input type="text" id="b1-img" placeholder="Paste Image Link Here">
            <span class="size-guide">‚ÑπÔ∏è Recommended Size: 1920 x 600 px (Wide Banner)</span>
            <input type="text" id="b1-link" placeholder="Paste YouTube Link Here">

            <label>Banner 2:</label>
            <input type="text" id="b2-img" placeholder="Paste Image Link Here">
            <span class="size-guide">‚ÑπÔ∏è Recommended Size: 1920 x 600 px (Wide Banner)</span>
            <input type="text" id="b2-link" placeholder="Paste YouTube Link Here">

            <label>Banner 3:</label>
            <input type="text" id="b3-img" placeholder="Paste Image Link Here">
            <span class="size-guide">‚ÑπÔ∏è Recommended Size: 1920 x 600 px (Wide Banner)</span>
            <input type="text" id="b3-link" placeholder="Paste YouTube Link Here">
        </div>

        <!-- 3. Video Grid -->
        <div class="section">
            <h3>3. Video Grid (6 Items)</h3>
            <div id="video-inputs"></div>
        </div>

        <!-- 4. Text Content (3 BOXES) -->
        <div class="section">
            <h3>4. Important Text Sections</h3>
            
            <div style="background: #fff; padding: 15px; border: 1px solid #ddd; border-radius: 5px; margin-bottom: 15px;">
                <label style="margin-top:0;">Text Box 1 (Title & Content):</label>
                <input type="text" id="txt-title" placeholder="Title 1">
                <textarea id="txt-desc" rows="4" placeholder="Content 1..."></textarea>
            </div>

            <div style="background: #fff; padding: 15px; border: 1px solid #ddd; border-radius: 5px; margin-bottom: 15px;">
                <label style="margin-top:0;">Text Box 2 (Title & Content):</label>
                <input type="text" id="txt-title-2" placeholder="Title 2">
                <textarea id="txt-desc-2" rows="4" placeholder="Content 2..."></textarea>
            </div>

            <div style="background: #fff; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
                <label style="margin-top:0;">Text Box 3 (Title & Content):</label>
                <input type="text" id="txt-title-3" placeholder="Title 3">
                <textarea id="txt-desc-3" rows="4" placeholder="Content 3..."></textarea>
            </div>
        </div>

        <!-- ADSTERRA NATIVE BANNER -->
        <div style="margin: 20px auto; text-align: center; max-width: 100%;">
            <script async="async" data-cfasync="false" src="https://pl28530993.effectivegatecpm.com/04804b2bd758cb3163372944a85a8bb2/invoke.js"></script>
            <div id="container-04804b2bd758cb3163372944a85a8bb2"></div>
        </div>
        <!-- END NATIVE BANNER -->

        <!-- 5. Statistics -->
        <div class="section">
            <h3>5. Statistics (Numbers)</h3>
            <div class="admin-stat-grid">
                <div><label>Years Exp:</label><input type="text" id="s1-num"><input type="text" id="s1-lbl"></div>
                <div><label>Projects:</label><input type="text" id="s2-num"><input type="text" id="s2-lbl"></div>
                <div><label>Running:</label><input type="text" id="s3-num"><input type="text" id="s3-lbl"></div>
                <div><label>Satisfaction:</label><input type="text" id="s4-num"><input type="text" id="s4-lbl"></div>
            </div>
        </div>

        <!-- 6. Bottom Left Notice -->
        <div class="section" style="border-left: 5px solid #28a745; background: #f0fff4;">
            <h3 style="margin-top: 0; color: #28a745;">üîî Bottom Left Notice Popup</h3>
            <label>Notice Content:</label>
            <textarea id="bottom-notice-text" rows="3" placeholder="Write your notice here... (Leave empty to disable)"></textarea>
        </div>

        <!-- 7. BLOG & NEWS MANAGEMENT (NEW SECTION) -->
        <div class="section" style="border-left: 5px solid #0056b3; background: #eef7ff;">
            <h3 style="margin-top: 0; color: #0056b3;">üì∞ Blog & News Management (30 Slots)</h3>
            <p>Select a News Slot number to edit that specific news.</p>
            
            <label>Select News Slot:</label>
            <select id="news-select" onchange="loadSpecificNews()">
                <!-- Options 1 to 30 generated by JS -->
            </select>

            <div style="background: white; padding: 20px; border-radius: 8px; border: 1px solid #ccc; margin-top: 15px;">
                <label>News Title:</label>
                <input type="text" id="news-title" placeholder="Enter News Headline">
                
                <label>Thumbnail Image Link:</label>
                <input type="text" id="news-img" placeholder="Paste Image Link">
                <span class="size-guide">‚ÑπÔ∏è Recommended Ratio: 16:9 (Example: 600x340 px)</span>
                
                <label>Date / Author:</label>
                <input type="text" id="news-date" placeholder="e.g. 21 Jan 2026 | Admin">

                <label>Full Content (Description):</label>
                <textarea id="news-desc" rows="10" placeholder="Write the full news article here... (Minimum 500 words recommended for AdSense)"></textarea>
            </div>
        </div>

        <button onclick="saveData()" style="padding: 15px; font-size: 1.2rem; background: #28a745;">SAVE ALL CHANGES</button>
        <button onclick="logout()" class="logout-btn">Logout</button>
    </div>

    <!-- MAIN POP-UP AD (300x250) -->
    <div class="popup-overlay" id="popup-ad">
        <div class="popup-content">
            <button class="popup-close" onclick="closePopup()">‚úñ</button>
            <h3 style="margin-bottom:10px;">Special Offer!</h3>
            
            <!-- ADSTERRA 300x250 CODE -->
            <div>
                <script>
                    atOptions = {
                        'key' : '08d5faeff146431c8017d7cfc9ab82b6',
                        'format' : 'iframe',
                        'height' : 250,
                        'width' : 300,
                        'params' : {}
                    };
                </script>
                <script src="https://www.highperformanceformat.com/08d5faeff146431c8017d7cfc9ab82b6/invoke.js"></script>
            </div>
            <!-- END AD CODE -->
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        // --- Firebase Config ---
        const firebaseConfig = {
            apiKey: "AIzaSyAEfAusfGr5VAhwbfpEjWBZijX0k3v3vAA",
            authDomain: "bangladesh-creator-media.firebaseapp.com",
            projectId: "bangladesh-creator-media",
            storageBucket: "bangladesh-creator-media.firebasestorage.app",
            messagingSenderId: "261777783760",
            appId: "1:261777783760:web:9dcacf82fdca071f4b97d5"
        };

        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const auth = firebase.auth();
        const db = firebase.firestore();

        // GLOBAL VARIABLE TO STORE ALL DATA
        let allData = {};

        // Generate Video Inputs
        const vidContainer = document.getElementById('video-inputs');
        for(let i=1; i<=6; i++) {
            vidContainer.innerHTML += `
                <div style="margin-top:15px; border-top:1px dashed #ccc; padding-top:10px;">
                    <strong>Video ${i}</strong>
                    <input type="text" id="v${i}-title" placeholder="Video Title">
                    <input type="text" id="v${i}-img" placeholder="Paste Thumbnail Link">
                    <span class="size-guide">‚ÑπÔ∏è Recommended Size: 1280 x 720 px</span>
                    <input type="text" id="v${i}-link" placeholder="Paste YouTube Link">
                </div>
            `;
        }

        // Generate News Dropdown Options (1-30)
        const newsSelect = document.getElementById('news-select');
        for(let i=1; i<=30; i++) {
            let option = document.createElement("option");
            option.value = i - 1; // Array index starts at 0
            option.text = "News Slot " + i;
            newsSelect.appendChild(option);
        }

        // Auth & Load Data
        auth.onAuthStateChanged(user => {
            if(user) {
                document.getElementById('login-section').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                loadData();
            } else {
                document.getElementById('login-section').style.display = 'block';
                document.getElementById('admin-panel').style.display = 'none';
            }
        });

        function login() {
            const e = document.getElementById('email').value;
            const p = document.getElementById('password').value;
            auth.signInWithEmailAndPassword(e, p)
                .then(() => alert("Login Successful!"))
                .catch(err => alert("Error: " + err.message));
        }

        function logout() { auth.signOut(); }

        // Load Data from Firebase
        function loadData() {
            db.collection('siteContent').doc('homePage').get().then(doc => {
                if(doc.exists) {
                    allData = doc.data(); // Store global data

                    // Basic Fields
                    if(allData.breakingNews) document.getElementById('breaking-news').value = allData.breakingNews;
                    if(allData.bottomNotice) document.getElementById('bottom-notice-text').value = allData.bottomNotice;

                    // Banners
                    if(allData.banners) {
                        allData.banners.forEach((b, i) => {
                            if(i<3) {
                                document.getElementById(`b${i+1}-img`).value = b.img || '';
                                document.getElementById(`b${i+1}-link`).value = b.link || '';
                            }
                        });
                    }

                    // Videos
                    if(allData.videos) {
                        allData.videos.forEach((v, index) => {
                            let i = index + 1;
                            if(i <= 6) {
                                document.getElementById(`v${i}-title`).value = v.title || '';
                                document.getElementById(`v${i}-img`).value = v.img || '';
                                document.getElementById(`v${i}-link`).value = v.link || '';
                            }
                        });
                    }

                    // Text Sections
                    if(allData.textSection) { document.getElementById('txt-title').value = allData.textSection.title || ''; document.getElementById('txt-desc').value = allData.textSection.desc || ''; }
                    if(allData.textSection2) { document.getElementById('txt-title-2').value = allData.textSection2.title || ''; document.getElementById('txt-desc-2').value = allData.textSection2.desc || ''; }
                    if(allData.textSection3) { document.getElementById('txt-title-3').value = allData.textSection3.title || ''; document.getElementById('txt-desc-3').value = allData.textSection3.desc || ''; }

                    // Stats
                    if(allData.stats) {
                        document.getElementById('s1-num').value = allData.stats.s1?.num || ''; document.getElementById('s1-lbl').value = allData.stats.s1?.lbl || '';
                        document.getElementById('s2-num').value = allData.stats.s2?.num || ''; document.getElementById('s2-lbl').value = allData.stats.s2?.lbl || '';
                        document.getElementById('s3-num').value = allData.stats.s3?.num || ''; document.getElementById('s3-lbl').value = allData.stats.s3?.lbl || '';
                        document.getElementById('s4-num').value = allData.stats.s4?.num || ''; document.getElementById('s4-lbl').value = allData.stats.s4?.lbl || '';
                    }

                    // Load First News (Slot 1)
                    loadSpecificNews();
                }
            });
        }

        // Helper to load inputs for specific news slot
        function loadSpecificNews() {
            const index = document.getElementById('news-select').value;
            // Ensure news array exists
            if(!allData.news) allData.news = [];
            
            const newsItem = allData.news[index] || {};
            
            document.getElementById('news-title').value = newsItem.title || '';
            document.getElementById('news-img').value = newsItem.img || '';
            document.getElementById('news-date').value = newsItem.date || '';
            document.getElementById('news-desc').value = newsItem.desc || '';
        }

        // Save Function
        function saveData() {
            // First, update the CURRENT selected news into the allData object
            const index = document.getElementById('news-select').value;
            if(!allData.news) allData.news = [];
            
            allData.news[index] = {
                title: document.getElementById('news-title').value,
                img: document.getElementById('news-img').value,
                date: document.getElementById('news-date').value,
                desc: document.getElementById('news-desc').value
            };

            // Prepare Main Object
            const dataToSave = {
                breakingNews: document.getElementById('breaking-news').value,
                bottomNotice: document.getElementById('bottom-notice-text').value,
                
                banners: [
                    { img: document.getElementById('b1-img').value, link: document.getElementById('b1-link').value },
                    { img: document.getElementById('b2-img').value, link: document.getElementById('b2-link').value },
                    { img: document.getElementById('b3-img').value, link: document.getElementById('b3-link').value }
                ],
                videos: [],
                textSection: { title: document.getElementById('txt-title').value, desc: document.getElementById('txt-desc').value },
                textSection2: { title: document.getElementById('txt-title-2').value, desc: document.getElementById('txt-desc-2').value },
                textSection3: { title: document.getElementById('txt-title-3').value, desc: document.getElementById('txt-desc-3').value },
                
                stats: {
                    s1: { num: document.getElementById('s1-num').value, lbl: document.getElementById('s1-lbl').value },
                    s2: { num: document.getElementById('s2-num').value, lbl: document.getElementById('s2-lbl').value },
                    s3: { num: document.getElementById('s3-num').value, lbl: document.getElementById('s3-lbl').value },
                    s4: { num: document.getElementById('s4-num').value, lbl: document.getElementById('s4-lbl').value }
                },

                // Important: Save the updated News Array
                news: allData.news
            };

            for(let i=1; i<=6; i++) {
                dataToSave.videos.push({
                    title: document.getElementById(`v${i}-title`).value,
                    img: document.getElementById(`v${i}-img`).value,
                    link: document.getElementById(`v${i}-link`).value
                });
            }

            db.collection('siteContent').doc('homePage').set(dataToSave)
                .then(() => alert('Website Updated Successfully! (News Saved)'))
                .catch(err => alert('Error: ' + err.message));
        }

        // --- POPUP AD LOGIC (ADMIN) ---
        window.addEventListener('load', function() {
            setTimeout(function() {
                if (!sessionStorage.getItem('popupClosedAdmin')) {
                    document.getElementById('popup-ad').style.display = 'flex';
                }
            }, 2000);
        });

        function closePopup() {
            document.getElementById('popup-ad').style.display = 'none';
            sessionStorage.setItem('popupClosedAdmin', 'true');
        }
    </script>

    <!-- ADSTERRA POPUNDER AD -->
    <script src="https://pl28528078.effectivegatecpm.com/ac/d5/c2/acd5c23b9f6f77e8f9f6ebae6a44ab89.js"></script>

    <!-- ADSTERRA SOCIAL BAR AD -->
    <script src="https://pl28528081.effectivegatecpm.com/ef/bf/ed/efbfedfbecfa4341c8c49c5e2eb5597a.js"></script>

    <!-- ADSTERRA SMARTLINK (Opens on First Click) -->
    <script>
        document.body.addEventListener('click', function() {
            if(!sessionStorage.getItem('smartLinkShownAdmin')) {
                window.open('https://www.effectivegatecpm.com/tvh8g9tv2?key=d1007f785c6fd53c1310c7811f50889e', '_blank');
                sessionStorage.setItem('smartLinkShownAdmin', 'true');
            }
        }, { once: true });
    </script>

</body>
</html>
